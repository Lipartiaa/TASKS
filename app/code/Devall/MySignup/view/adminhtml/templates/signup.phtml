<?php
/** @var $block \Devall\MySignup\Block\Adminhtml\Signup */
$collection = $block->getSignupCollection();
?>
<div class="admin__data-grid">
    <h2><?php echo __('Sign Ups') ?></h2>
    <?php if ($collection->getSize()): ?>
        <table class="data-grid">
            <thead>
            <tr>
                <th><?php echo __('ID') ?></th>
                <th><?php echo __('Name') ?></th>
                <th><?php echo __('Date') ?></th>
                <th><?php echo __('Actions') ?></th>
            </tr>
            </thead>
            <tbody>
            <?php foreach ($collection as $item): ?>
                <tr>
                    <td><?php echo $item->getData('signup_id'); ?></td>
                    <td><?php echo $item->getData('name'); ?></td>
                    <td><?php echo $item->getData('date'); ?></td>
                    <td class="action-buttons">
                        <!-- Delete ღილაკი -->
                        <a href="#" class="action delete" data-id="<?php echo $item->getData('signup_id'); ?>">
                            <?php echo __('Delete'); ?>
                        </a>
                    </td>
                </tr>
            <?php endforeach; ?>
            </tbody>
        </table>
    <?php else: ?>
        <p><?php echo __('No sign ups found.'); ?></p>
    <?php endif; ?>
</div>

<style>
    .admin__data-grid {
        font-family: Arial, sans-serif;
        padding: 20px;
        background-color: #fff;
        border-radius: 8px;
        border: 2px solid #ff7f00;
        width: 90%;
        max-width: 1100px;
        align-items: center;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        text-align: left;
    }

    .admin__data-grid h2 {
        font-size: 24px;
        color: #ff7f00;
        text-align: left;
    }

    .data-grid {
        width: 100%;
        border-collapse: collapse;
        margin-top: 20px;
    }

    .data-grid th, .data-grid td {
        padding: 12px;
        text-align: left;
        border: 2px solid #ff7f00;
    }

    .data-grid th {
        background-color: #ff7f00;
        color: white;
        font-weight: bold;
    }

    .data-grid tr:nth-child(even) {
        background-color: #fffaf0;
    }

    .data-grid tr:nth-child(odd) {
        background-color: #ffffff;
    }

    .data-grid tr:hover {
        background-color: #ffaf40;
        color: #fff;
    }

    .data-grid td {
        color: #555;
        font-size: 16px;
    }

    .action-buttons {
        display: flex;
        justify-content: flex-start;
        gap: 10px;
    }

    .action {
        text-decoration: none;
        font-weight: bold;
        padding: 8px 12px;
        border-radius: 5px;
        transition: 0.3s ease;
    }

    .action.delete {
        background-color: #dc3545;
        color: white;
        border: 2px solid #c82333;
        cursor: pointer;
    }

    .action.delete:hover {
        background-color: #c82333;
    }

    p {
        font-size: 18px;
        color: #ff7f00;
        text-align: left;
    }
</style>

<script type="text/javascript">
    require(['jquery', 'mage/url', 'Magento_Ui/js/modal/confirm'], function ($, url, confirm) {
        $(document).on('click', '.action.delete', function (e) {
            e.preventDefault();
            var signupId = $(this).data('id');
            var row = $(this).closest('tr'); // მივიღებთ ამოღებულ რიგს

            confirm({
                content: 'Are you sure you want to delete this signup?',
                actions: {
                    confirm: function () {
                        $.ajax({
                            url: url.build('mysignup/index/delete'),
                            type: 'POST',
                            data: { id: signupId },
                            showLoader: true,
                            success: function (response) {
                                if (response.success) {
                                    row.remove(); // წაშლის მხოლოდ ამ კონკრეტულ რიგს
                                } else {
                                    alert('Error: ' + response.message);
                                }
                            },
                            error: function () {
                                alert('Something went wrong.');
                            }
                        });
                    }
                }
            });
        });
    });
</script>
